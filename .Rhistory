ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Price",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Price STDV",
low = "lightblue",
high = "darkblue"
)
par(mfrow = c(1,1))
par(mfrow = c(2,2))
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Price",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Price STDV",
low = "lightblue",
high = "darkblue"
)
par(mfrow = c(1,1))
df_grp <- df_new[,c("jis_code", "price", "reviewCount")] %>%
group_by(jis_code) %>%
summarize(
total_price = sum(price),
av_price = mean(price),
stdv_price = sd(price),
total_reviews = sum(reviewCount),
av_reviews = mean(reviewCount),
stdv_reviews = sd(reviewCount)
)
glimpse(df_grp)
df <- merge(df, df_grp , by.x = "pref_code", by.y = "jis_code", all.x = T )
glimpse(df)
# Plotting
par(mfrow = c(2,2))
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "lightblue",
high = "darkblue"
)
df <- merge(df, df_grp , by.x = "pref_code", by.y = "jis_code", all.x = T )
glimpse(df)
# 3. Right before for-loops, set a progress-bar. Note that "length" usually goes like "nrow(df)".
pb <- create_new_pb(length(unique(df_new$jis_code)))
df <- NULL
for(code in unique(df_new$jis_code)){
# 4. Inside for-loops, describe "pb$tick()"
pb$tick()
df_add <- jpn_pref(code)
if(length(df) > 0){
df <- rbind(df, df_add)
}else {
df <- df_add
}
}
summary(df)
glimpse(data_copied)
df_grp <- df_new[,c("jis_code", "price", "reviewCount")] %>%
group_by(jis_code) %>%
summarize(
total_price = sum(price),
av_price = mean(price),
stdv_price = sd(price),
total_reviews = sum(reviewCount),
av_reviews = mean(reviewCount),
stdv_reviews = sd(reviewCount)
)
glimpse(df_grp)
df <- merge(df, df_grp , by.x = "pref_code", by.y = "jis_code", all.x = T )
glimpse(df)
# Plotting
par(mfrow = c(2,1))
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Reviews",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_views
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Reviews",
low = "lightblue",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Reviews",
low = "lightblue",
high = "darkblue"
)
##
par(mfrow = c(1,1))
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
low = "lightblue",
high = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
low = "orange",
high = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "orange",
low = "darkblue"
)
# Plotting
par(mfrow = c(3,2))
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "orange",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Reviews",
low = "orange",
high = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Price",
low = "orange",
high = "darkblue"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = av_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Average Reviews",
low = "orange",
high = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Price STDV",
high = "orange",
low = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "orange",
low = "darkblue"
)
##
par(mfrow = c(1,1))
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "red",
low = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0.001,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "red",
low = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0.001,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "white",
low = "darkblue"
)
##
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = stdv_reviews
),
colour = "lightgray",
size = 0.001,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Reviews STDV",
high = "white",
low = "darkblue"
) +
theme(
panel.background = element_blank()
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "red",
high = "darkblue"
) +
theme(
panel.background = element_blank(),
panel.border = "lightgray"
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "white",
high = "darkblue"
) +
theme(
panel.background = element_blank(),
panel.border = element_line()
)
df %>%
ggplot() +
geom_sf(
aes(
group = pref_code,
fill = total_price
),
colour = "lightgray",
size = 0,
show.legend = TRUE
) +
scale_fill_continuous(
name = "Total Price",
low = "white",
high = "darkblue"
) +
theme(
panel.background = element_blank(),
panel.border = element_rect()
)
